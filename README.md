# EngageX

**Цель:**  Создание модели взаимодействия с пользователями для повышения числа результативных действий по сравнению с текущей стратегией. 

## Описание задачи
На основе данных о триггерах и результативных действиях пользователей требуется построить модель, которая будет рекомендовать оптимальные взаимодействия. Основные ограничения и параметры:
- Ограничение частоты взаимодействий (не чаще, чем раз в две недели).
- Бинарная цель — повысить число заинтересованных пользователей.

## Данные
Использованы два датасета:
- **triggers.csv** — содержит ID пользователя, дату, тип взаимодействия и идентификатор триггера.
- **actions.csv** — содержит ID пользователя, дату и статус результата взаимодействия (0 — не заинтересован, 1 — заинтересован).

## Подход к решению

1. **Предобработка данных**  
   - Объединение данных о триггерах и действиях.
   - Создание признаков, включая частоту взаимодействий и время с момента последнего триггера.
   - Соблюдение ограничения на частоту взаимодействий.

2. **Построение модели**  
   - Выбор XGBoost как модели, учитывая его эффективность в задачах классификации.
   - Балансировка классов с использованием SMOTE и настройки `scale_pos_weight`. Другие методы избежание дисбаланса: 1. пополнение датасета для уменьшения дисбаланса классов. 2. Попробовать сгенирировать синтетические данные, через какую-нибудь gpt-model, при правильном промпте, данные почти не будут отличаться от реальных.
   - Подбор гиперпараметров с помощью `GridSearchCV`.

3. **Оценка качества**  
   - Использованы метрики **ROC AUC** и **F1-score**.
   - Важность признаков для интерпретации модели.

## Используемые библиотеки
```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt 
import seaborn as sns
from datetime import timedelta
from sklearn.model_selection import train_test_split, GridSearchCV
from sklearn.metrics import roc_auc_score, f1_score, classification_report
from xgboost import XGBClassifier
from imblearn.over_sampling import SMOTE
```

## Результаты
- **AUC на обучающей выборке:** 0.91
- **AUC на тестовой выборке:** 0.91
- **Важные признаки:** Время с момента последнего триггера, тип взаимодействия.
